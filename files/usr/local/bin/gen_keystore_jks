#!/usr/bin/env bash

if [ ! -d $CATALINA_BASE/ssl ] && [ -d /ssl ]; then
    mkdir $CATALINA_BASE/ssl && \
    cd $CATALINA_BASE/ssl && \
    openssl pkcs12 -export \
                    -password pass:"" \
                    -in /ssl/ssl.crt \
                    -inkey /ssl/ssl.key \
                    --certfile /ssl/ssl.crt \
                    -out keystore.p12 && \
    keytool -importkeystore \
            -srckeystore keystore.p12 \
            -srcstoretype pkcs12 \
            -destkeystore keystore.jks \
            -deststoretype JKS \
            -deststorepass changeit \
            -srcstorepass "" && \
    rm keystore.p12 && \
    cd -
fi
